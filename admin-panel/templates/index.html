{% extends "base.html" %}

{% block title %}Dashboard - NewEra Bot Admin Panel{% endblock %}

{% block content %}
<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h3><i class="bi bi-speedometer2"></i> Dashboard Overview</h3>
      </div>
      <div class="card-body">
        <div class="row">
          <!-- Countries Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Countries', 0) }}</div>
              <small class="text-muted">Countries</small>
            </div>
          </div>
          <!-- Governments Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Governments', 0) }}</div>
              <small class="text-muted">Government Positions</small>
            </div>
          </div>
          <!-- Structures Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Structures', 0) }}</div>
              <small class="text-muted">Structures</small>
            </div>
          </div>
          <!-- Regions Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Regions', 0) }}</div>
              <small class="text-muted">Regions</small>
            </div>
          </div>
        </div>

        <div class="row mt-4">
          <!-- Technologies Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Technologies', 0) }}</div>
              <small class="text-muted">Technologies</small>
            </div>
          </div>
          <!-- Productions Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Productions', 0) }}</div>
              <small class="text-muted">Active Productions</small>
            </div>
          </div>
          <!-- Doctrines Stats -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ tables_info.get('Doctrines', 0) }}</div>
              <small class="text-muted">Doctrines</small>
            </div>
          </div>
          <!-- Game Management -->
          <div class="col-md-3 mb-3">
            <div class="table-card p-3 text-center">
              <div class="stat-number">{{ current_date.year if current_date else 'N/A' }}</div>
              <small class="text-muted">Current Game Year</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h5><i class="bi bi-lightning-charge"></i> Quick Actions</h5>
          </div>
          <div class="card-body">
            <div class="d-grid gap-2">
              <a href="/countries/add" class="btn btn-primary">
                <i class="bi bi-plus-lg"></i> Add New Country
              </a>
              <a href="/structures/add" class="btn btn-success">
                <i class="bi bi-building"></i> Add New Structure
              </a>
              <a href="/technologies/add" class="btn btn-info">
                <i class="bi bi-cpu"></i> Add New Technology
              </a>
              <a href="/game-date/advance" class="btn btn-warning">
                <i class="bi bi-skip-forward"></i> Advance Game Date
              </a>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="row mt-5">
          <div class="col-12">
            <div class="table-card p-4">
              <h5><i class="bi bi-lightning"></i> Quick Actions</h5>
              
              <div class="row">
                <!-- Game Management Actions -->
                <div class="col-md-6">
                  <h6 class="text-muted">Game Management</h6>
                  <div class="btn-group-vertical d-grid gap-2" role="group">
                    <a href="/countries/add" class="btn btn-primary">
                      <i class="bi bi-plus"></i> Add Country
                    </a>
                    <a href="/governments/add" class="btn btn-success">
                      <i class="bi bi-plus"></i> Add Government Position
                    </a>
                    <a href="/doctrines/add" class="btn btn-dark">
                      <i class="bi bi-plus"></i> Add Doctrine
                    </a>
                    <a href="/regions/add" class="btn btn-info">
                      <i class="bi bi-plus"></i> Add Region
                    </a>
                    <a href="/structures/add" class="btn btn-warning">
                      <i class="bi bi-plus"></i> Add Structure
                    </a>
                    <a href="/technologies/add" class="btn btn-danger">
                      <i class="bi bi-plus"></i> Add Technology
                    </a>
                    <a href="/inventory/add" class="btn btn-secondary">
                      <i class="bi bi-plus"></i> Add Inventory
                    </a>
                  </div>
                </div>
                
                <!-- Admin & User Actions -->
                <div class="col-md-6">
                  <h6 class="text-muted">Administration & Account</h6>
                  <div class="btn-group-vertical d-grid gap-2" role="group">
                    {% if session.is_admin %}
                    <a href="/users" class="btn btn-outline-primary">
                      <i class="bi bi-person-gear"></i> Manage Users
                    </a>
                    <a href="/users/add" class="btn btn-outline-success">
                      <i class="bi bi-person-plus"></i> Add New User
                    </a>
                    {% endif %}
                    <a href="/change_password" class="btn btn-outline-dark">
                      <i class="bi bi-key"></i> Change Password
                    </a>
                    <div class="btn-group" role="group">
                      <a href="#" class="btn btn-outline-info" onclick="location.reload()">
                        <i class="bi bi-arrow-clockwise"></i> Refresh
                      </a>
                      <a href="/logout" class="btn btn-outline-danger">
                        <i class="bi bi-box-arrow-right"></i> Logout
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- User Info -->
        <div class="row mt-4">
          <div class="col-12">
            <div class="table-card p-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <small class="text-muted">Logged in as</small>
                  <h6 class="mb-0">
                    <i class="bi bi-person-circle"></i> {{ session.username }}
                    {% if session.is_admin %}
                    <span class="badge bg-primary ms-2">Administrator</span>
                    {% endif %}
                  </h6>
                </div>
                <div class="text-end">
                  <small class="text-muted">Last Activity</small>
                  <div class="small" id="currentTime"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Update current time
    function updateTime() {
      const now = new Date();
      const timeStr = now.toLocaleString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      });
      document.getElementById('currentTime').textContent = timeStr;
    }
    
    // Update time every second
    updateTime();
    setInterval(updateTime, 1000);
    
    // Add hover effects to statistics cards
    document.querySelectorAll('.table-card').forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
        this.style.boxShadow = '0 8px 16px rgba(0, 0, 0, 0.2)';
      });
      
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
      });
    });
  </script>
</body>
</html>
